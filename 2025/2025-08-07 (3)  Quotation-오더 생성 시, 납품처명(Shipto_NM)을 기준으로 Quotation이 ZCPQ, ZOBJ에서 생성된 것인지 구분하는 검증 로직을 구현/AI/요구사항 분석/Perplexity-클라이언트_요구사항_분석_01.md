# 아래의 내용을 좀 더 명확하게 하기 위해 질문을 한다면 어떤 것들을 물어보면 좋을까?

개발 목적

오더 생성 시, 납품처명(Shipto_NM)을 기준으로 Quotation이 ZCPQ(OneCRM)에서 생성된 것인지, ZOBJ(기존 시스템)에서 생성된 것인지 구분하여 검증 로직을 구현합니다.

ZOBJ: 기존 시스템에서 생성된 Quotation.
ZCPQ: 최근 도입된 OneCRM 시스템에서 생성된 Quotation.
 

 

요구 사항

1. Quotation 검증 로직

오더 생성 시, 납품처명(Shipto_NM)을 기준으로 Quotation의 출처를 구분하고, 이에 따라 검증 단계를 진행합니다.

조건 1: 납품처명에 'KR' 포함 여부 확인
Shipto_NM에 'KR'이 prefix로 포함된 경우:
해당 Quotation은 ZCPQ(OneCRM) 에서 생성된 것으로 간주합니다.
품목 검증(2번) 을 진행합니다.
참고: ZCPQ에서 생성된 모든 납품처명은 'KR'로 시작하며, 이는 필수값입니다.
예시:
Shipto_NM = KR_수서지점 공사현장 → ZCPQ로 간주, 품목 검증 진행.
 

Shipto_NM에 'KR'이 포함되지 않은 경우:
해당 Quotation은 ZOBJ(기존 시스템)에서 생성된 것으로 간주합니다.
품목 검증(2번) 없이 바로 주문 접수를 진행합니다.
예시:
Shipto_NM = 한국목재 인천지점 → ZOBJ로 간주, 품목 검증 생략.
 

 

*예외 처리*

특정 조건에 따라 Quotation 검증 로직에서 예외 처리를 적용합니다.

예외 1: ZOBJ Quotation인데 납품처명에 'KR'이 포함된 경우
예: Shipto_NM = KR산업 (실제 업체명이 'KR'로 시작). -> 현재는 KR산업 1건만 해당
이 경우, 해당 Quotation은 ZOBJ로 간주하며, 품목 검증을 생략합니다.
 

예외 2: 납품처명에 'KR'이 중복으로 포함된 경우
예: Shipto_NM = KR_KR산업.
이 경우, 해당 Quotation은 ZCPQ로 간주하며, 품목 검증을 진행합니다.
 

 

2. 품목 유무 검증 (해당 로직은 최근 개발 완료)

ZCPQ Quotation의 품목 유무를 확인하여 주문 접수 가능 여부를 결정합니다.
검증 방법:

O_Quotation_Verification 테이블을 사용하여 품목 검증을 진행합니다.
품목이 있는 경우: 주문 접수를 진행합니다.
품목이 없는 경우: 주문 접수가 불가합니다.

---------------------------------------------------------------------


좋아, 너가 지금 정리해 준 요구사항은 로직 구현 방향이 꽤 명확하지만, 실제 개발 들어가기 전에 몇 가지 세부사항을 더 확인해야 할 부분들이 있어.  
이런 걸 미리 물어보고 정의해 두면 개발 도중에 혼선이 줄어들어.  

***

## 내가 물어볼 질문 리스트
아래 질문들을 관련자(기획자·업무 담당자·데이터 담당자)와 확인하는 게 좋아.

### 1. **Shipto_NM 판단 로직 관련**
1. **Shipto_NM 필드의 데이터 출처**  
   - ERP/SAP 같은 단일 출처인지, 아니면 여러 시스템에서 들어오는 값인지?  
   - 대소문자 구분 여부(`KR`, `kr`, `Kr` 모두 동일로 처리?)  
2. **‘KR’ Prefix 판별 규칙**  
   - 정확히 `"KR_"`로 시작해야 하는지, 아니면 `"KR"`로만 시작해도 인정?  
     예: `KR_서울`, `KR서울` → 둘 다 ZCPQ인가?  
3. **특수문자/공백 처리**  
   - Shipto_NM 값 앞뒤 공백, 특수문자(`-`, `_`) 가능성 있음?  
   - 로직 적용 전 `TRIM`, `UPPER` 처리해야 하나?
4. **예외 1 (KR산업)**  
   - KR산업은 항상 ZOBJ로 고정인지, 아니면 유연하게 예외 목록(화이트리스트) 관리해야 하는지?  
     DB 테이블에 예외 관리 기능 필요?  
5. **예외 2 (KR_KR...)**  
   - 중복된 KR 판별 기준은 단어 단위로 나눠 보나, 단순 문자열 찾기인가?  
     예: `"KR_KR"` vs `"KRKR"` 구분?

***

### 2. **품목 검증 로직 관련**
1. **O_Quotation_Verification 테이블 구조**  
   - Primary Key는 Quotation No? Shipto_NM?  
   - 품목 유무는 어느 컬럼(예: `ITEM_COUNT` > 0?)으로 확인?  
2. **품목 없는 경우 처리 방식**  
   - 주문 생성 자체를 막는지? 아니면 경고 후 관리자 승인 필요?  
3. **품목 검증 시점**  
   - 오더 생성 직전 1회만 확인? 아니면 단계별 재검증?  
4. **품목 검증 실패 시 로그**  
   - 실패 건 로그를 별도 테이블이나 로그 파일에 쌓아야 하나?  

***

### 3. **업무 프로세스 & 운영 고려**
1. **ZCPQ/ZOBJ 구분 결과 저장 여부**  
   - 단순 로직 내 판단만 할 건지, 아니면 DB 컬럼에 저장해 추적? (`SOURCE_SYSTEM` = 'ZCPQ'/'ZOBJ')  
2. **향후 예외 케이스 관리 계획**  
   - 새로운 예외 업체가 생길 경우를 대비해 테이블 기반 예외 관리가 필요한지?  
3. **성능 고려**  
   - 오더 생성 시 실시간 DB 조회가 가능? 아니면 캐시나 사전 적재 방식 사용?  

***

### 4. **비즈니스 용어 통일**
- "납품처명"이 전 시스템에서 동일하게 쓰이는 필드인지? (혹시 다른 이름: Shipto Name, Delivery To 등)
- Quotation 번호와 Shipto_NM이 1:1인지, 1:다인지?

***

## 내 제안
이 질문들을 미리 정리해서 업무 담당자한테 한 번에 물어보면 개발 중 변경 가능성을 최소화할 수 있어.  
만약 원하면 내가 **이 로직 플로우 차트 + SQL 설계안**을 바로 만들어 줄 수도 있어.  

***

너가 원하면 내가 바로 **구현용 로직 다이어그램이랑 실제 SQL 조건문 예시**로 만들어 줄까?  
그렇게 하면 질문 정리하면서 바로 반영도 가능해.