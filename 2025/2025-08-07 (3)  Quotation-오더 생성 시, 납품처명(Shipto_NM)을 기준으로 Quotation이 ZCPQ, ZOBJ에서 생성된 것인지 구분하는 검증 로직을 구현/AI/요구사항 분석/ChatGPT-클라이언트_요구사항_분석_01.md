# 아래의 내용을 좀 더 명확하게 하기 위해 질문을 한다면 어떤 것들을 물어보면 좋을까?

개발 목적

오더 생성 시, 납품처명(Shipto_NM)을 기준으로 Quotation이 ZCPQ(OneCRM)에서 생성된 것인지, ZOBJ(기존 시스템)에서 생성된 것인지 구분하여 검증 로직을 구현합니다.

ZOBJ: 기존 시스템에서 생성된 Quotation.
ZCPQ: 최근 도입된 OneCRM 시스템에서 생성된 Quotation.
 

 

요구 사항

1. Quotation 검증 로직

오더 생성 시, 납품처명(Shipto_NM)을 기준으로 Quotation의 출처를 구분하고, 이에 따라 검증 단계를 진행합니다.

조건 1: 납품처명에 'KR' 포함 여부 확인
Shipto_NM에 'KR'이 prefix로 포함된 경우:
해당 Quotation은 ZCPQ(OneCRM) 에서 생성된 것으로 간주합니다.
품목 검증(2번) 을 진행합니다.
참고: ZCPQ에서 생성된 모든 납품처명은 'KR'로 시작하며, 이는 필수값입니다.
예시:
Shipto_NM = KR_수서지점 공사현장 → ZCPQ로 간주, 품목 검증 진행.
 

Shipto_NM에 'KR'이 포함되지 않은 경우:
해당 Quotation은 ZOBJ(기존 시스템)에서 생성된 것으로 간주합니다.
품목 검증(2번) 없이 바로 주문 접수를 진행합니다.
예시:
Shipto_NM = 한국목재 인천지점 → ZOBJ로 간주, 품목 검증 생략.
 

 

*예외 처리*

특정 조건에 따라 Quotation 검증 로직에서 예외 처리를 적용합니다.

예외 1: ZOBJ Quotation인데 납품처명에 'KR'이 포함된 경우
예: Shipto_NM = KR산업 (실제 업체명이 'KR'로 시작). -> 현재는 KR산업 1건만 해당
이 경우, 해당 Quotation은 ZOBJ로 간주하며, 품목 검증을 생략합니다.
 

예외 2: 납품처명에 'KR'이 중복으로 포함된 경우
예: Shipto_NM = KR_KR산업.
이 경우, 해당 Quotation은 ZCPQ로 간주하며, 품목 검증을 진행합니다.
 

 

2. 품목 유무 검증 (해당 로직은 최근 개발 완료)

ZCPQ Quotation의 품목 유무를 확인하여 주문 접수 가능 여부를 결정합니다.
검증 방법:

O_Quotation_Verification 테이블을 사용하여 품목 검증을 진행합니다.
품목이 있는 경우: 주문 접수를 진행합니다.
품목이 없는 경우: 주문 접수가 불가합니다.

---------------------------------------------------------------------


좋아요. 그럼 위 내용을 **요구사항 확인서** 형식의 표로 정리해 드릴게요.
바로 회의나 검토 문서에 붙여넣어 사용할 수 있게 구성했습니다.

---

## 📌 Quotation 검증 로직 요구사항 확인서

| 구분                | 질문                         | 선택지 / 참고                         | 비고                       |
| ----------------- | -------------------------- | -------------------------------- | ------------------------ |
| **Shipto\_NM 판별** | 1. `KR` 판별 시 대소문자 구분 여부    | 대소문자 구분 / 미구분                    | UPPER/LOWER 처리 여부        |
|                   | 2. 앞뒤 공백, 구분자 처리 방식        | `_`만 허용 / 공백, `-`, 기타 구분자 허용     | 예: `" KR_지점"`, `"KR-지점"` |
|                   | 3. 예외 업체 관리 방식             | 하드코딩 / DB 테이블 / 환경설정 파일          | 현재 `"KR산업"`만 해당          |
| **예외 처리**         | 4. 예외 1 `"KR산업"` 외 확장 시 처리 | 코드 수정 / 예외 목록 관리                 | 확장 가능성 여부                |
|                   | 5. 예외 2 `"KR_KR산업"` 처리 범위  | 2번만 허용 / `KR` 중복 횟수 무관           | 예: `"KR_KR_지점"`          |
| **품목 검증**         | 6. 품목 유무 기준                | Quotation 번호 / Shipto\_NM        | 조회 키 명확화                 |
|                   | 7. ‘품목 없음’ 판정 조건           | 수량=0 포함 / 제외                     | 취소품목 처리 포함 여부            |
|                   | 8. 검증 실패 시 동작              | 팝업 후 중단 / 로그만 남김 / 메시지 출력 후 중단   | 메시지 형식 결정 필요             |
| **시스템 연동**        | 9. 적용 시점                   | 오더 생성 시만 / 수정·재주문 시 포함           |                          |
|                   | 10. Shipto\_NM 변경 시 재판별 여부 | 예 / 아니오                          | 중간 변경 로직 필요 여부           |
|                   | 11. 보조 판별 조건 사용 여부         | Shipto\_NM만 / Quotation 번호 패턴 추가 | 패턴 규칙 확인 필요              |
| **성능·유지보수**       | 12. 검증 시 성능 고려             | Shipto\_NM 판별 후 필요한 경우만 품목 조회    | 대량 처리 시 영향               |
|                   | 13. 예외 목록 변경 시 배포 방식       | 코드 재배포 / SQL 수정                  | 운영 반영 절차                 |
|                   | 14. 테스트 데이터 준비 방식          | ZCPQ, ZOBJ, 예외 각각 케이스 포함         | QA 시나리오 필수               |

---

이 표를 기반으로 각 항목에 대해 **Yes/No, 선택지, 구체 예시**를 채우면,
바로 구현 상세 설계서로 연결 가능합니다.

---

원하시면 이걸 **테스트 시나리오**랑 바로 매칭해서 작성해 드릴 수도 있습니다.
그렇게 하면 개발 → QA까지 한 번에 준비됩니다.
