
| ----------- | ------------- | ------ |
|   오더번호   |   QMS오더번호   |  SEQ   |
| ----------- | ------------- | ------ |
|      1      |       N       |        |
|             |       1       |   N    |
| ----------- | ------------- | ------ |


오더번호
    └─ QMS오더번호
        └─ SEQ




1. QMS관리 > QMS 조회 및 등록 메뉴 화면에서 그리드의 목록 현재 오더번호를 기준
    - QMS오더번호를 하나만 보여줌.
    - Q4MS 수량은 QMS오더번호의 합
    => 오더번호별 QMS오더번호를 전부 조회.
    => 현재처럼 오더번호만 보여주고 QMS메일발송 시에 해당 오더번호에 생성된 QMS오더번호 건들을 보여줌.


| ----------- | ------------------------------------------------------------------------------------ |
| 구분         | 내용                                                                                 |
| ----------- | ------------------------------------------------------------------------------------ |
| 상황         | - QMS오더번호를 하나만 보여줌.                                                          |
|             |  - Q4MS 수량은 QMS오더번호의 합                                                         |
| ----------- | ------------------------------------------------------------------------------------ |
| 처리방안     | - 오더번호별 QMS오더번호를 전부 조회.                                                     |
|             | - 현재처럼 오더번호만 보여주고, QMS메일발송 시 해당 오더번호에 생성된 QMS오더번호 건들을 보여줌.  |
| ----------- | ------------------------------------------------------------------------------------ |




2. QMS관리 > QMS 조회 및 등록
    - QMS 입력 탭을 클릭하면 QMS 입력 팝업이 뜸
        사전작업 :
            1. QMS 오더번호 생성
            2. QMS_ORD_MAST 생성
                - QMS_ID : QMS오더번호
                - QMS_SEQ : 1
                - DELETEYN : 'T'
            3. QMS_ORD_FRCN 생성
                - QMS_ID : QMS오더번호
                - QMS_SEQ : 1
            4. QMS_ORD_DETL 생성
                - QMS_ID : QMS오더번호
                - QMS_SEQ : 1

    - QMS 입력 팝업
        저장 버튼
            - 팝업의 내용을 저장
            - DELETEYN : 'Y'
            - 팝업 닫힘

        삭제 버튼
            - DELETEYN : 'N'
            - 팝업 닫힘

        닫기 버튼
            - 사전작업에서 생성한 데이터 삭제.
                대상 테이블 : QMS_ORD_MAST, QMS_ORD_FRCN, QMS_ORD_DETL
            - 팝업 닫힘

        현장분할 버튼
            - QMS_SEQ가 1이 증가된 새로운 QMS를 생성
            - 현장정보의 현장명을 입력해주세요. 라는 메시지와 함께 진행되지 않음.


        ※ 세션 만료 등의 예기치 못한 상황.
            - 사전작업으로 생성된 데이터 존재
            - DELETEYN 값 : 'T'
            - 쓰레기 데이터로 남음.



| --------------- | -------------------------------------------------------------------------- |
| 버튼명           | 동작 및 처리 플로우                                                           |
| --------------- | -------------------------------------------------------------------------- |
| QMS 입력 탭      | 클릭 시 QMS 입력 팝업이 뜸                                                    |
|                 |                                                                            |
|                 | 사전작업:                                                                   |
|                 | 1. QMS 오더번호 생성                                                         |
|                 | 2. QMS\_ORD\_MAST 생성(QMS\_ID: QMS오더번호, QMS\_SEQ: 1, DELETEYN: 'T')     |
|                 | 3. QMS\_ORD\_FRCN 생성(QMS\_ID, QMS\_SEQ: 1)                                |
|                 | 4. QMS\_ORD\_DETL 생성(QMS\_ID, QMS\_SEQ: 1) |                              |
| --------------- | -------------------------------------------------------------------------- |
| 저장             | - 팝업 내용 저장                                                             |
|                 | - DELETEYN: 'Y'                                                            |
|                 | - 팝업 닫힘                                                                 |
| --------------- | -------------------------------------------------------------------------- |
| 삭제             | - DELETEYN: 'N'                                                            |
|                 | - 팝업 닫힘                                                                 |
| --------------- | -------------------------------------------------------------------------- |
| 닫기             | - 사전작업 데이터 삭제(QMS\_ORD\_MAST, QMS\_ORD\_FRCN, QMS\_ORD\_DETL)        |
|                 | - 팝업 닫힘                                                                 |
| --------------- | -------------------------------------------------------------------------- |
| 현장분할         | - QMS\_SEQ 1 증가된 QMS 생성                                                 |
|                 | - 현장정보의 현장명 입력 안내 메시지 출력, 진행되지 않음                           |
| --------------- | -------------------------------------------------------------------------- |
| 세션 만료 등 예외 | - 사전작업 데이터 존재 시                                                      |
|                 | - DELETEYN: 'T' 상태로 데이터가 쓰레기로 남음                                  |
| --------------- | -------------------------------------------------------------------------- |




[QMS 입력 탭 클릭]
      |
      v
[QMS 입력 팝업]
      |
  +---+---+---+---+
  |   |   |   |   |
저장 삭제 닫기 현장분할
  |   |   |   |
  |   |   |   +--> QMS_SEQ증가 → 현장명 미입력시 진행불가(메시지 안내)
  |   |   +--> 사전작업 데이터 삭제 → 팝업 닫힘
  |   +--> DELETEYN:N → 팝업 닫힘
  +--> 팝업내용 저장 → DELETEYN:Y → 팝업 닫힘

<예외>
세션 만료 등 → 사전작업 데이터 존재, DELETEYN:'T'로 남음


