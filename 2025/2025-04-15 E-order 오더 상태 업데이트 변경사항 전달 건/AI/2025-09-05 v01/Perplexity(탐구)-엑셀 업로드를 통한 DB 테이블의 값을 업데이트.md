작업 흐름 문서 – 엑셀 업로드 기반 주문 테이블 동기화  
(적용 공식: 문제 재정의·분석, 다차원 통찰, 혁신 솔루션 생성, 복잡도 해소, 순차적 사고·성장 구조 적용)  
사용 공식: PR(문제 재정의), MDA(다차원 분석), GI(통찰 도출), IS/IA(혁신·확산), CS(구성 분해), TE/IL/IW(성장·직관·통합)  

***

## 1. 요구사항 파악 및 정책 정의

### 1.1 작업명
요구사항 확인 및 정책 정립

### 개요
엑셀 기반 주문 테이블 동기화 진행을 위해 관련 기능/절차/정책을 명확하게 정의하는 단계

### 내용
- 엑셀 파일의 구조와 변동성(컬럼 수·순서·형태·대용량 등) 파악
- DB테이블(임시, 운영) 및 매칭·업데이트 정책 정립
- 처리 우선순위 및 오류 처리(리포트) 기준 명확화
- 대용량 처리 및 진행률 표시 영향도 분석
- 담당자·일정·협업 범위 지정

***

## 2. 웹 기능 및 UI/UX 설계

### 2.1 작업명
엑셀 업로드 및 진행 UI/UX 설계

### 개요
사용자가 엑셀 파일을 업로드하고 진행상황을 웹에서 확인·리포트 받을 수 있도록 UI/UX구조 수립

### 내용
- 엑셀 업로드 기능(파일 선택·업로드 버튼 등) 설계
- 대량 처리 진행률 표시(게이지·%·잔여 건수 등) UI 설계
- 업로드 후 실패 건 출력용 리포트 화면 설계(키값·사유 포함)
- 사용성 개선(알림, 예외 입력 안내 등) 반영

***

## 3. 임시테이블 생성 및 스키마 자동화 설계

### 3.1 작업명
임시테이블 자동 생성 및 관리 정책

### 개요
유동적인 엑셀 구조(컬럼 수/순서/명칭)의 파일을 운영 DB에 반영 가능하도록 임시테이블을 자동으로 생성·관리하는 단계

### 내용
- 엑셀 파일 구조를 동적으로 분석해 임시테이블 컬럼·타입 자동 설계
- 컬럼 타입·명칭 mapping 정책 수립(필수 컬럼 유무 체크)
- 테이블 생성/삭제 정책 및 보존 기간 정립
- 대용량(13000행 이상) 업로드 시 성능 고려(트랜잭션 분할, 배치 등)

***

## 4. 엑셀 데이터 업로드 및 임시테이블 적재

### 4.1 작업명
엑셀 데이터 임시테이블 적재

### 개요
엑셀 파일 전체 데이터를 임시테이블에 신속히 적재, 후속비교·업데이트 효율성 확보

### 내용
- 엑셀 데이터 유효성 점검(필수 컬럼 체크, 포맷 오류 등)
- 임시테이블에 엑셀 파일 전체 데이터 적재(배치 처리)
- 적재 후 데이터 건수·적재상태 실시간 진행률 제공

***

## 5. 데이터 매칭·업데이트 로직 설계 및 수행

### 5.1 작업명
운영 테이블 매칭 및 동기화 처리

### 개요
임시테이블과 운영테이블을 컬럼·키 조건으로 비교, 지정항목 우선순위 따라 동기화 작업을 실행

### 내용
- 주문 번호+아이템번호*100을 키로 DB테이블과 데이터 매칭
- 임시테이블 값 비교 후 [우선순위] 1→2→3번 조건에 따라 상태값 업데이트  
- 두 운영 테이블(O_SALESORDER, QMS_SALESORDER) 동시 처리  
- 처리 건수·진행률 실시간 반영

***

## 6. 오류 처리 및 실패 리포트 관리

### 6.1 작업명
오류/실패 건 리포트 테이블 관리

### 개요
실패 및 예외 처리 건의 상세 정보를 리포트 형태로 관리, 사용자에게 결과 제공

### 내용
- 실패건 관리 용도 테이블 설계(키값, 실패사유, 시간 등 기록)
- 작업 결과 리포트(실패 건 리스트 및 사유) 운영UI 연동
- 후속조치·개선점 도출을 위한 로그/리포트 제공 체계 구축

***

## 7. 테스트(개발·QA) 및 운영 적용

### 7.1 작업명
기능 검증 및 운영 반영 절차

### 개요
새로운 데이터 동기화 로직 및 화면 기능 전체를 테스트하고 실제 운영환경에 적용

### 내용
- 개발 환경(윈도우, STS, Maven 등)에서 기능별 검증
- QA 환경에서 엑셀 파일 다양한 케이스별 테스트 진행
- 운영 적용 전 검증서 및 승인받기(공통 테스트, 롤백 방안 포함)
- 정식 배포 및 사용자 안내

***

## 단계별 작업 체크리스트

| 단계 | 주요 작업 | 담당 |
|------|------------|------|
| 요구·정책 정립 | 구조·업무 규칙 확인 | 개발·기획·운영 |
| UI/UX 설계 | 엑셀 업로드·진행률·리포트 화면 | 개발·기획 |
| 임시테이블 자동화 | 테이블/컬럼 동적 생성·관리 | 개발(DBA) |
| 데이터 적재 | 엑셀 데이터 유효성·적재 | 개발 |
| 매칭·업데이트 | 운영DB 동기화·상태 로직 | 개발 |
| 실패 리포트 | 오류 정보 관리·리포트 화면 연결 | 개발·운영 |
| 테스트·운영 반영 | 검증·테스트·배포 | QA·운영 |

***

## 주요 이슈 관리 체크리스트

- □ 엑셀 파일 구조/컬럼 동적 처리 검증  
- □ 임시테이블 성능/정책 점검  
- □ 대량 데이터 처리 속도 확인  
- □ 진행률 표시 동작·부하 영향도 판단  
- □ 실패리포트 DB 설계 및 UI 반영  
- □ 제어 흐름(우선순위, 롤백 포함) 체크  
- □ 전체 정책 변경·관리 모니터링  

***

이 문서는 다양한 담당자가 반복적으로 참고할 수 있도록 단계별 작업 흐름에 따라 작성되었습니다.