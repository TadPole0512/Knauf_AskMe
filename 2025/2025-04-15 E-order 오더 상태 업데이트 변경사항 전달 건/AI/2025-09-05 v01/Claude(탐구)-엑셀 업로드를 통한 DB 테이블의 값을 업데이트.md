## 사용한 분석 공식

**Problem Redefinition Algorithm (PR)**: 단순 엑셀 업로드에서 대용량 데이터 배치 처리 시스템으로 문제 재정의
**Multidimensional Analysis Framework (MDA)**: 성능(D1), 사용성(D2), 안정성(D3) 차원에서 분석
**Complexity Resolution Matrix (CS)**: 대용량 처리, 동적 스키마, 실시간 모니터링을 독립 모듈로 분해하여 복잡도 해결

---

# 엑셀 업로드 기반 주문 상태 업데이트 시스템 구축 작업 흐름

## 1단계: 사전 준비 및 설계

### 1.1 기술 검토 및 아키텍처 설계
**개요**: 대용량 엑셀 처리를 위한 시스템 아키텍처 설계

**작업 내용**:
- [ ] Apache POI 라이브러리 성능 검토 및 대안 분석
- [ ] 스프링 배치 프레임워크 도입 검토
- [ ] 비동기 처리 방식 설계 (CompletableFuture 또는 스프링 Async)
- [ ] 임시 테이블 동적 생성 전략 수립
- [ ] 진행률 추적을 위한 세션 관리 방안 설계

### 1.2 데이터베이스 스키마 설계
**개요**: 임시 테이블 및 작업 관리용 테이블 설계

**작업 내용**:
- [ ] 동적 임시 테이블 명명 규칙 정의
- [ ] 작업 진행 상태 추적 테이블 설계
- [ ] 실패 로그 저장 테이블 설계
- [ ] 임시 테이블 자동 정리 정책 수립

## 2단계: 백엔드 개발

### 2.1 엑셀 파일 업로드 컨트롤러 개발
**개요**: 멀티파트 파일 업로드 및 초기 검증 처리

**작업 내용**:
- [ ] 파일 크기 제한 설정 (최대 50MB)
- [ ] 엑셀 파일 형식 검증 (xlsx, xls)
- [ ] 업로드 즉시 작업 ID 생성 및 반환
- [ ] 비동기 처리 작업 시작 트리거

### 2.2 엑셀 파일 분석 및 임시 테이블 생성 서비스
**개요**: 엑셀 구조 분석 후 동적 임시 테이블 생성

**작업 내용**:
- [ ] 엑셀 첫 번째 행에서 컬럼명 추출
- [ ] 필수 컬럼 존재 여부 검증
- [ ] 각 컬럼의 데이터 타입 자동 판별
- [ ] 유니크한 임시 테이블명 생성
- [ ] 동적 DDL 생성 및 실행

### 2.3 엑셀 데이터 임시 테이블 적재 서비스
**개요**: 대용량 엑셀 데이터를 배치로 임시 테이블에 저장

**작업 내용**:
- [ ] 스트리밍 방식 엑셀 읽기 구현
- [ ] 배치 단위 설정 (1,000행씩 처리)
- [ ] PreparedStatement 활용 벌크 인서트
- [ ] 메모리 사용량 최적화
- [ ] 진행률 계산 및 업데이트

### 2.4 주문 상태 업데이트 서비스
**개요**: 임시 테이블 기반 대용량 업데이트 처리

**작업 내용**:
- [ ] 우선순위별 업데이트 로직 구현
- [ ] 배치 업데이트 방식으로 성능 최적화
- [ ] 트랜잭션 단위 설정 (5,000건씩)
- [ ] 실패 건에 대한 상세 로그 수집
- [ ] 양 테이블 동시 업데이트 보장

### 2.5 진행률 추적 및 결과 리포트 서비스
**개요**: 실시간 진행률 제공 및 최종 결과 생성

**작업 내용**:
- [ ] 웹소켓 기반 실시간 진행률 전송
- [ ] 작업 단계별 상태 관리
- [ ] 성공/실패 통계 생성
- [ ] 실패 건 상세 정보 정리
- [ ] 임시 테이블 자동 삭제

## 3단계: 프론트엔드 개발

### 3.1 엑셀 업로드 인터페이스 개발
**개요**: 사용자 친화적인 파일 업로드 화면

**작업 내용**:
- [ ] 드래그 앤 드롭 파일 업로드 구현
- [ ] 파일 선택 시 즉시 검증 피드백
- [ ] 업로드 버튼 활성화/비활성화 제어
- [ ] 파일 정보 미리보기 (크기, 형식)

### 3.2 진행률 표시 화면 개발
**개요**: 작업 진행 상황을 시각적으로 표시

**작업 내용**:
- [ ] 프로그레스 바 구현
- [ ] 단계별 진행 상태 표시
- [ ] 예상 소요 시간 계산 및 표시
- [ ] 취소 기능 구현

### 3.3 결과 리포트 화면 개발
**개요**: 작업 완료 후 결과 요약 및 상세 정보 제공

**작업 내용**:
- [ ] 전체 처리 건수 및 성공률 표시
- [ ] 실패 건 목록 테이블 구현
- [ ] 실패 사유별 분류 및 통계
- [ ] 결과 엑셀 다운로드 기능

## 4단계: 데이터베이스 구성

### 4.1 작업 관리 테이블 생성
**개요**: 업로드 작업 추적을 위한 테이블

**작업 내용**:
- [ ] 작업 ID, 시작시간, 종료시간, 상태 컬럼 포함
- [ ] 파일명, 파일크기, 총 행수 정보 저장
- [ ] 처리된 건수, 성공 건수, 실패 건수 추적
- [ ] 임시 테이블명 매핑 정보 저장

### 4.2 실패 로그 테이블 생성
**개요**: 업데이트 실패 건에 대한 상세 정보 저장

**작업 내용**:
- [ ] 작업 ID 참조 외래키 설정
- [ ] 실패한 행 번호 및 키값 저장
- [ ] 실패 사유 및 에러 메시지 저장
- [ ] 실패 발생 시점 기록

### 4.3 인덱스 최적화
**개요**: 대용량 업데이트 성능 향상을 위한 인덱스 구성

**작업 내용**:
- [ ] O_SALESORDER, QMS_SALESORDER 테이블 인덱스 점검
- [ ] ORDERNO, LINE_NO 복합 인덱스 확인
- [ ] 임시 테이블용 인덱스 자동 생성 로직 구현

## 5단계: 성능 최적화

### 5.1 배치 처리 최적화
**개요**: 대용량 데이터 처리 성능 개선

**작업 내용**:
- [ ] 배치 크기별 성능 테스트 및 최적값 도출
- [ ] 메모리 사용량 모니터링 및 튜닝
- [ ] 커넥션 풀 설정 최적화
- [ ] 트랜잭션 타임아웃 설정

### 5.2 동시성 제어
**개요**: 다중 사용자 업로드 시 안정성 보장

**작업 내용**:
- [ ] 동시 업로드 건수 제한 설정
- [ ] 임시 테이블명 충돌 방지 로직
- [ ] 리소스 경합 최소화 방안 적용

## 6단계: 테스트

### 6.1 단위 테스트
**개요**: 각 모듈별 기능 검증

**작업 내용**:
- [ ] 엑셀 파싱 로직 테스트 케이스 작성
- [ ] 임시 테이블 생성 테스트
- [ ] 업데이트 로직 단위 테스트
- [ ] 예외 상황 처리 테스트

### 6.2 통합 테스트
**개요**: 전체 프로세스 연동 테스트

**작업 내용**:
- [ ] 다양한 엑셀 파일 형식 테스트
- [ ] 대용량 파일 처리 테스트 (13,000행 이상)
- [ ] 동시 업로드 시나리오 테스트
- [ ] 실패 상황별 처리 테스트

### 6.3 성능 테스트
**개요**: 실제 운영 환경 기준 성능 검증

**작업 내용**:
- [ ] 최대 처리 시간 측정
- [ ] 메모리 사용량 모니터링
- [ ] 데이터베이스 부하 테스트
- [ ] 사용자 경험 품질 검증

## 7단계: 배포 및 운영

### 7.1 배포 준비
**개요**: 운영 환경 배포를 위한 사전 작업

**작업 내용**:
- [ ] 운영 환경 설정 파일 준비
- [ ] 데이터베이스 스키마 배포 스크립트 작성
- [ ] 백업 및 롤백 계획 수립
- [ ] 모니터링 설정 구성

### 7.2 사용자 교육 및 문서화
**개요**: 원활한 서비스 활용을 위한 지원 자료 준비

**작업 내용**:
- [ ] 사용자 매뉴얼 작성
- [ ] 엑셀 파일 템플릿 제공
- [ ] 오류 상황별 대처 가이드 작성
- [ ] 운영자용 관리 매뉴얼 작성

### 7.3 모니터링 및 유지보수 체계 구축
**개요**: 안정적인 서비스 운영을 위한 관리 체계

**작업 내용**:
- [ ] 임시 테이블 정리 배치 작업 스케줄링
- [ ] 시스템 리소스 모니터링 설정
- [ ] 오류 알림 체계 구축
- [ ] 정기 성능 점검 계획 수립