# 아래는 특정 고객 담당자 및 담당 영업사원에게 D+1(익일착) 주문에 대하여 특정시간에 메일(내용+첨부파일(엑셀))을 전달하는 기능을 위한 DB 테이블 정보야.
아래의 내용을 검토해서 메일 예약 시스템 구축을 위한 DB 테이블 정보를 구성하는데 더 필요한 정보가 뭐가 있을까?

```diff
주문메일알람
  - 거래처코드, 담장자 이메일, 담당자 이메일 발송 여부, 영업 담당 이메일, 영업 담당 이메일 발송 여부, 비고, 생성자, 생성일, 수정자, 수정일

에약발송정보
  - 스케줄ID, 스케줄명, 스케줄시작일, 스케줄시각, 스케줄분, 사용여부, 비고, 생성자, 생성일, 수정자, 수정일

예약발송로그
  - 스케줄ID, 거래처 코드, 담당자 이메일, 발송여부, 발송시각, 발송 정보, 실패 코드, 실패 메시지, 생성자, 생성일
```
```
[개발환경]
- 운영체제 : 윈도우
- 개발툴 : STS4.5
- 자바 : Zulu-8
- WAS : Tomcat 9
- DB : mssql
- Maven
- MyBatis
- JQGrid
```

---------------------------------------------------------------------

---

안녕하세요! 친구가 보내준 내용을 봤는데, 메일 예약 시스템 구축을 위한 DB 테이블 정보가 벌써 꽤 구체적이네요. 말씀하신 내용을 토대로 몇 가지 더 고려하면 좋을 만한 부분을 함께 고민해봤어요.

### **1. DB 테이블 구성 보강**

지금 구성만으로도 시스템 운영은 가능하지만, 유연성을 높이고 추후 발생할 수 있는 여러 상황에 더 잘 대처하기 위해 아래와 같은 정보들을 추가하면 좋을 것 같아요.

* **`주문메일알람` 테이블:**
    * **메일 템플릿 ID**: 메일 내용이 고정된 텍스트가 아닌 경우를 대비해, 템플릿을 관리하는 별도 테이블을 만들고 여기에서 ID를 참조하도록 하는 게 좋아요. 이렇게 하면 메일 내용을 수정할 때마다 코드를 변경할 필요가 없어서 훨씬 편해져요.
    * **첨부파일 정보**: 현재 첨부파일이 엑셀 파일이라고 하셨는데, 첨부파일의 경로, 파일명, 파일 확장자 등을 별도로 저장해두면 좋아요. 혹시 나중에 다른 종류의 파일(PDF 등)을 첨부하거나 파일명이 바뀌더라도 쉽게 대응할 수 있어요.
* **`예약발송정보` 테이블:**
    * **스케줄 주기(cron 표현식)**: 현재는 특정 시각(시, 분)으로 설정되어 있는데, 매일, 매주, 매월 등 다양한 주기로 메일을 보내야 할 경우를 대비해 스케줄링 도구(예: Quartz)에서 사용하는 **cron 표현식**을 저장하면 훨씬 유연한 스케줄 관리가 가능해요. `0 0 9 * * ?`처럼 표현해서 매일 오전 9시에 실행되도록 할 수 있어요.
    * **재발송 횟수 / 재발송 주기**: 메일 발송이 실패했을 때를 대비해서, 자동으로 몇 번까지 재발송을 시도할지, 그리고 얼마 간격으로 재시도할지에 대한 정보를 추가하면 시스템 안정성을 높일 수 있어요.
    * **스케줄 최종 실행 시간**: 스케줄이 마지막으로 성공적으로 실행된 시각을 기록하면, 혹시나 시스템 오류 등으로 인해 스케줄이 누락되었을 때 마지막 실행 시간을 기준으로 다음 실행 시간을 계산하는 데 도움이 돼요.
* **`예약발송로그` 테이블:**
    * **메일 발송 제목/내용**: 로그에 어떤 제목과 내용으로 메일이 발송되었는지까지 기록해두면, 나중에 특정 시점에 어떤 내용으로 메일이 발송되었는지 추적하기가 훨씬 쉬워져요.
    * **재발송 여부**: 이 로그가 재발송된 기록인지 아닌지를 구분할 수 있는 필드를 추가해두면, 발송 실패 원인을 분석할 때 유용해요.

---

### **2. 고려하면 좋을 추가 테이블**

현재 테이블 구성에 아래 두 가지 테이블을 추가하면 관리와 확장이 훨씬 용이할 거예요.

* **`메일템플릿` 테이블**:
    * **템플릿 ID (PK)**
    * **템플릿명**
    * **메일 제목**
    * **메일 본문 (HTML)**
    * **생성일 / 수정일 등**

    메일 내용을 DB에서 관리함으로써, 메일 내용 수정 시 배포 없이 바로 적용할 수 있어요.

* **`첨부파일관리` 테이블**:
    * **파일 ID (PK)**
    * **파일 논리명** (사용자가 알아보기 쉬운 이름)
    * **파일 물리명** (서버에 저장된 실제 파일명)
    * **파일 경로**
    * **생성일 / 수정일 등**

    첨부파일 정보를 별도로 관리하면, 다양한 종류의 파일을 유연하게 관리할 수 있고, 파일 추가/삭제도 용이해요.

이런 식으로 테이블을 조금 더 세분화해서 관리하면 시스템의 유연성과 유지보수성이 크게 향상될 거예요. 궁금한 점 있으면 언제든 다시 이야기해줘요! 😊