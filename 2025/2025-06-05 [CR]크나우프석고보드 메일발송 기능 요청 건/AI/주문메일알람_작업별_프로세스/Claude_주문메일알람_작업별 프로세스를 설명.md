## 💾 아래의 내용을 검토한 다음 DB 작업 및 프로그램 작업을 나누어 각 작업별 프로세스를 설명해줘.


필수컬럼 => 코드/거래처명/담당자이메일/이메일발송여부/영업 담당 이메일/이메일발송여부
```sql
CUST_CD    VARCHAR(10)
CUST_MAIN_EMAIL    VARCHAR(100)
CUST_SENDMAIL_YN    VARCHAR(1)
SALESREP_EMAIL    VARCHAR(100)
SALESREP_SENDMAIL_YN VARCHAR(1)
INID    VARCHAR(10)
INDATE    DATETIME2
MOID    VARCHAR(10)
MODATE    DATETIME2
CONSTRAINT PR_CUST_CD PRIMARY KEY(CUST_CD)
```

## 💻  E-Order Admin – 거래처관리 – 주문 메일 알람(New)
특정 고객 담당자 및 담당 영업사원에게 D+1(익일착) 주문에 대하여 특정시간에 메일(내용+첨부파일(엑셀))을 전달하는 기능(Daily)

* **O_CUSTOMER의 정보를 그대로 전달 받을 수 있도록 하는 신규 테이블 생성**
	* 담당자 이메일 / 영업 담당 이메일이 수정을 할 수 있어야 함(필요에 따라 O_CUSTOMER와 달라질 수 있음(담당자가 여러명인 거래처 등))
	* ( O_CUSTOMER의 테이블에 신규 정보 입력 시 그대로 가져오도록 필요 => 동기화 시점 고려)
­
* **체크박스를 제공하여 체크 된 담당자/영업담당자에게만 메일이 전송 되도록 처리 필요**
	* 정렬은 체크된 거래처가 우선으로 보이게 함(체크된 거래처 -> 코드순 정렬 / 가장 상위로 변경)
	* 체크 박스가 두개인 이유는 필요에 따라 담당자 혹은 영업담당자만 메일을 받아야 할 수도 있기 때문

* **메일 형식은 제공된 메일 및 엑셀과 동일하게 전송 필요**
	* 제목 및 내용은 형식에 맞춰서 전송 필요

* **메일 발송 시각 설정**
	* 메일 발송 시각은 필요에 따라 변경 될 수 있기에 유저가 능동적으로 입력 할 수 있도록 설정(1시간 단위)**
	* 메일 발송 시각의 관리 방법이 필요

* **메일 발송 로그 기록**
	* 발송 성공 여부 등



---------------------------------------------------------------------

제공해주신 내용을 검토한 후 DB 작업과 프로그램 작업으로 나누어 각 작업별 프로세스를 설명드리겠습니다.

## 1. DB 작업 프로세스

### 1.1 신규 테이블 생성 작업
**테이블명: ORDER_MAIL_CUSTOMER (또는 유사한 명명)**
```sql
필수 컬럼:
- CUST_CD VARCHAR(10) -- 고객코드 (PK)
- CUST_NAME VARCHAR(100) -- 거래처명
- CUST_MAIN_EMAIL VARCHAR(100) -- 담당자이메일
- CUST_SENDMAIL_YN VARCHAR(1) -- 담당자 이메일발송여부
- SALESREP_EMAIL VARCHAR(100) -- 영업담당이메일
- SALESREP_SENDMAIL_YN VARCHAR(1) -- 영업담당 이메일발송여부
- REG_DATE DATETIME -- 등록일시
- UPD_DATE DATETIME -- 수정일시
```

### 1.2 메일 발송 시간 관리 테이블 생성
**테이블명: MAIL_SEND_CONFIG**
```sql
- CONFIG_ID VARCHAR(20) -- 설정ID (PK)
- SEND_HOUR INT -- 발송시간 (0-23)
- IS_ACTIVE VARCHAR(1) -- 활성화여부
- REG_DATE DATETIME -- 등록일시
- UPD_DATE DATETIME -- 수정일시
```

### 1.3 메일 발송 로그 테이블 생성
**테이블명: MAIL_SEND_LOG**
```sql
- LOG_ID BIGINT -- 로그ID (PK, AUTO_INCREMENT)
- SEND_DATE DATE -- 발송일자
- CUST_CD VARCHAR(10) -- 고객코드
- EMAIL_TYPE VARCHAR(10) -- 이메일타입 (CUST/SALES)
- EMAIL_ADDR VARCHAR(100) -- 발송이메일주소
- SEND_STATUS VARCHAR(10) -- 발송상태 (SUCCESS/FAIL)
- ERROR_MSG VARCHAR(500) -- 오류메시지
- SEND_DATETIME DATETIME -- 발송일시
```

### 1.4 O_CUSTOMER 테이블 동기화 트리거/프로시저 생성
- O_CUSTOMER 테이블에 INSERT/UPDATE 발생 시 ORDER_MAIL_CUSTOMER 테이블로 데이터 동기화

## 2. 프로그램 작업 프로세스

### 2.1 관리자 화면 개발 (E-Order Admin)
**화면 경로: E-Order Admin > 거래처관리 > 주문 메일 알람**

#### 2.1.1 거래처 목록 화면
- 체크박스가 체크된 거래처 우선 표시 (체크된 거래처 → 코드순 정렬)
- 거래처별 담당자/영업담당자 이메일 표시
- 각각의 발송여부 체크박스 제공
- 실시간 수정 기능 (Ajax 방식)

#### 2.1.2 메일 발송 시간 설정 화면
- 발송 시간 설정 (1시간 단위, 0-23시)
- 현재 설정된 발송 시간 표시
- 설정 변경 기능

#### 2.1.3 발송 로그 조회 화면
- 일자별 발송 내역 조회
- 성공/실패 현황 표시
- 오류 메시지 상세 조회

### 2.2 배치 프로그램 개발
#### 2.2.1 메일 발송 배치 작업
**실행 주기: Daily (설정된 시간)**

**프로세스:**
1. 메일 발송 시간 설정 조회
2. D+1 주문 데이터 조회
3. 발송 대상 거래처 목록 조회 (발송여부 Y인 경우만)
4. 거래처별 주문 데이터를 엑셀 파일로 생성
5. 메일 템플릿 기반 메일 내용 생성
6. 담당자/영업담당자 이메일 발송
7. 발송 결과 로그 기록

#### 2.2.2 O_CUSTOMER 동기화 배치 (옵션)
- 실시간 트리거가 어려운 경우 배치로 동기화 처리
- 주기적으로 O_CUSTOMER와 ORDER_MAIL_CUSTOMER 동기화

### 2.3 메일 발송 모듈 개발
#### 2.3.1 메일 템플릿 관리
- 제목 템플릿 (일자, 거래처명 등 동적 치환)
- 본문 템플릿 (주문 내역 요약 등)

#### 2.3.2 엑셀 파일 생성 모듈
- 거래처별 D+1 주문 데이터를 엑셀로 변환
- 제공된 엑셀 형식과 동일하게 생성

#### 2.3.3 메일 발송 모듈
- SMTP 설정 기반 메일 발송
- 첨부파일 처리
- 발송 결과 반환 (성공/실패, 오류메시지)

## 3. 개발 순서 및 고려사항

### 3.1 개발 순서
1. DB 테이블 생성 및 동기화 로직 구현
2. 관리자 화면 개발 (거래처 관리)
3. 메일 발송 모듈 개발
4. 배치 프로그램 개발
5. 로그 조회 화면 개발
6. 통합 테스트

### 3.2 주요 고려사항
- **동기화 시점**: O_CUSTOMER 변경 시 실시간 반영 방식 결정
- **메일 발송 실패 처리**: 재발송 로직 및 알림 방식
- **성능**: 대량 거래처 처리 시 배치 성능 최적화
- **보안**: 이메일 주소 개인정보 보호
- **모니터링**: 배치 실행 상태 및 오류 알림 체계

이러한 프로세스로 진행하시면 체계적으로 주문 메일 알림 기능을 구현할 수 있을 것입니다.