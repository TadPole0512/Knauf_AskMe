## 💾 아래의 내용을 검토한 다음 DB 작업 및 프로그램 작업을 나누어 각 작업별 프로세스를 설명해줘.


필수컬럼 => 코드/거래처명/담당자이메일/이메일발송여부/영업 담당 이메일/이메일발송여부
```sql
CUST_CD    VARCHAR(10)
CUST_MAIN_EMAIL    VARCHAR(100)
CUST_SENDMAIL_YN    VARCHAR(1)
SALESREP_EMAIL    VARCHAR(100)
SALESREP_SENDMAIL_YN VARCHAR(1)
INID    VARCHAR(10)
INDATE    DATETIME2
MOID    VARCHAR(10)
MODATE    DATETIME2
CONSTRAINT PR_CUST_CD PRIMARY KEY(CUST_CD)
```

## 💻  E-Order Admin – 거래처관리 – 주문 메일 알람(New)
특정 고객 담당자 및 담당 영업사원에게 D+1(익일착) 주문에 대하여 특정시간에 메일(내용+첨부파일(엑셀))을 전달하는 기능(Daily)

* **O_CUSTOMER의 정보를 그대로 전달 받을 수 있도록 하는 신규 테이블 생성**
	* 담당자 이메일 / 영업 담당 이메일이 수정을 할 수 있어야 함(필요에 따라 O_CUSTOMER와 달라질 수 있음(담당자가 여러명인 거래처 등))
	* ( O_CUSTOMER의 테이블에 신규 정보 입력 시 그대로 가져오도록 필요 => 동기화 시점 고려)
­
* **체크박스를 제공하여 체크 된 담당자/영업담당자에게만 메일이 전송 되도록 처리 필요**
	* 정렬은 체크된 거래처가 우선으로 보이게 함(체크된 거래처 -> 코드순 정렬 / 가장 상위로 변경)
	* 체크 박스가 두개인 이유는 필요에 따라 담당자 혹은 영업담당자만 메일을 받아야 할 수도 있기 때문

* **메일 형식은 제공된 메일 및 엑셀과 동일하게 전송 필요**
	* 제목 및 내용은 형식에 맞춰서 전송 필요

* **메일 발송 시각 설정**
	* 메일 발송 시각은 필요에 따라 변경 될 수 있기에 유저가 능동적으로 입력 할 수 있도록 설정(1시간 단위)**
	* 메일 발송 시각의 관리 방법이 필요

* **메일 발송 로그 기록**
	* 발송 성공 여부 등




---------------------------------------------------------------------



요청하신 내용을 바탕으로 **DB 작업**과 **프로그램 작업**으로 나누어 각 프로세스를 설명해 드리겠습니다.

---

## 💾 DB 작업 프로세스

DB 작업은 메일 발송 기능에 필요한 데이터를 저장하고 관리하기 위한 구조를 설계하고 구축하는 과정입니다.

1.  **메일 발송 대상 관리 테이블 생성**
    * **테이블명 (예시):** `MAIL_ALARM_TARGET`
    * **컬럼 구성:**
        * `CUST_CD` (거래처 코드, PK): `VARCHAR(10)`
        * `CUST_MAIN_EMAIL` (담당자 이메일): `VARCHAR(100)`
        * `CUST_SENDMAIL_YN` (담당자 발송 여부): `VARCHAR(1)` (Y/N, 기본값 'N')
        * `SALESREP_EMAIL` (영업 담당 이메일): `VARCHAR(100)`
        * `SALESREP_SENDMAIL_YN` (영업 담당 발송 여부): `VARCHAR(1)` (Y/N, 기본값 'N')
        * 기타 관리용 컬럼 (등록일, 수정일 등)
    * **역할:** E-Order Admin 화면에서 사용자가 직접 수정하고 관리할 정보가 저장됩니다.

2.  **데이터 동기화 프로세스 구축**
    * **목표:** `O_CUSTOMER` 테이블에 신규 거래처가 추가되면, `MAIL_ALARM_TARGET` 테이블에도 해당 정보가 자동으로 추가되도록 합니다.
    * **구현 방법 (선택):**
        * **트리거 (Trigger):** `O_CUSTOMER` 테이블에 `INSERT`가 발생할 때 `MAIL_ALARM_TARGET` 테이블에 자동으로 데이터를 추가하는 트리거를 생성합니다.
        * **배치 (Batch):** 특정 시간마다 주기적으로 `O_CUSTOMER` 테이블과 `MAIL_ALARM_TARGET` 테이블을 비교하여 누락된 거래처 정보를 추가하는 스케줄러를 개발합니다.

3.  **메일 발송 시간 관리 테이블 생성**
    * **테이블명 (예시):** `MAIL_CONFIG`
    * **컬럼 구성:**
        * `CONFIG_ID` (설정 ID, PK)
        * `SEND_TIME` (발송 시각): `VARCHAR(2)` (예: '08', '15' 등 시간만 저장)
    * **역할:** 사용자가 설정한 메일 발송 시간을 저장하여, 프로그램이 해당 시간에 동작할 수 있도록 기준 정보를 제공합니다.

4.  **메일 발송 로그 테이블 생성**
    * **테이블명 (예시):** `MAIL_SEND_LOG`
    * **컬럼 구성:**
        * `LOG_SEQ` (로그 순번, PK)
        * `SEND_DTTM` (발송 일시): `DATETIME`
        * `CUST_CD` (거래처 코드): `VARCHAR(10)`
        * `RECEIVER_EMAIL` (수신자 이메일): `VARCHAR(100)`
        * `SEND_STATUS` (발송 상태): `VARCHAR(1)` (S: 성공, F: 실패)
        * `ERROR_MSG` (에러 메시지): `VARCHAR(1000)`
    * **역할:** 메일 발송 결과를 기록하여 추후 문제 발생 시 원인을 파악하거나 통계를 내는 데 사용됩니다.

---

## 💻 프로그램 작업 프로세스

프로그램 작업은 사용자가 DB에 저장된 데이터를 조회, 수정하고 정해진 로직에 따라 실제 기능이 동작하도록 개발하는 과정입니다.

### 1. 거래처 관리 화면 개발 (E-Order Admin)

* **데이터 조회:**
    * `MAIL_ALARM_TARGET` 테이블의 정보를 조회하여 화면에 목록 형태로 출력합니다.
    * **정렬 로직:** `CUST_SENDMAIL_YN`, `SALESREP_SENDMAIL_YN` 중 하나라도 'Y'인 데이터를 우선적으로 표시하고, 그다음 `CUST_CD` 순으로 정렬하는 쿼리를 작성합니다.
* **데이터 수정 기능:**
    * 사용자는 화면에서 담당자/영업 담당 이메일 주소를 직접 수정할 수 있습니다.
    * '이메일 발송 여부' 컬럼을 **체크박스** 형태로 구현하여, 사용자가 클릭하면 'Y' 또는 'N' 값으로 `MAIL_ALARM_TARGET` 테이블에 즉시 업데이트하는 로직을 개발합니다.
* **발송 시간 설정 UI:**
    * `MAIL_CONFIG` 테이블의 `SEND_TIME` 값을 조회하고, 사용자가 1시간 단위로 시간을 선택하여 저장(UPDATE)할 수 있는 UI(예: 드롭다운 메뉴)를 제공합니다.

### 2. 메일 발송 배치(Batch) 프로그램 개발

* **스케줄러 설정:**
    * 배치 프로그램이 **매일, 매시간 정각**에 실행되도록 스케줄러(Scheduler)에 등록합니다.
* **발송 로직:**
    1.  프로그램이 실행되면 먼저 `MAIL_CONFIG` 테이블에서 사용자가 설정한 **발송 시간(`SEND_TIME`)을 확인**합니다.
    2.  현재 시간과 설정된 발송 시간이 일치하지 않으면 프로그램을 즉시 종료합니다.
    3.  시간이 일치하면, D+1(익일 도착) 주문 데이터를 조회하여 **엑셀 파일을 생성**합니다.
    4.  `MAIL_ALARM_TARGET` 테이블에서 `CUST_SENDMAIL_YN` 또는 `SALESREP_SENDMAIL_YN`이 **'Y'로 체크된 대상 목록을 조회**합니다.
    5.  조회된 대상 목록을 순회하며, 정해진 제목과 본문 형식에 맞춰 생성된 엑셀 파일을 첨부하여 **메일을 발송**합니다.
    6.  각 메일 발송 건에 대한 **성공/실패 여부를 `MAIL_SEND_LOG` 테이블에 기록**합니다. (성공 시 'S', 실패 시 'F'와 함께 에러 내용 기록)